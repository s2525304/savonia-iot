# ============================================================
# Azure bootstrap environment
# Used by CLI scripts to create Azure resources
# Copy this file to `azure.env` and fill in the values
# ============================================================

# Azure subscription where resources will be created
AZURE_SUBSCRIPTION_ID="00000000-0000-0000-0000-000000000000"

# Azure region (examples: westeurope, northeurope, eastus)
AZURE_LOCATION="westeurope"

# Resource group name (must be globally unique within subscription)
AZURE_RESOURCE_GROUP="savonia-iot-dev"

# Optional short prefix for naming resources later
# (will be used when we add more services)

AZURE_NAME_PREFIX="savoniaiot"

# ============================================================
# IoT Hub
# ============================================================

# IoT Hub name (must be globally unique). Example: savoniaiot-iothub-dev
IOTHUB_NAME="savoniaiot-iothub-dev"

# IoT Hub SKU (typical: F1 for free tier (one per subscription), S1 for production)
IOTHUB_SKU="S1"

# IoT Hub unit count (S1 supports scaling units; keep 1 for small setups)

IOTHUB_UNITS="1"

# Retention time (in days) for IoT Hub built-in Event Hub–compatible endpoint
# Default is 1 day, max is 7 days (S1+). We use 5 days for deploy safety.
IOTHUB_RETENTION_DAYS="5"

# ============================================================
# Storage Queues (post-validation fan-out)
# ============================================================

# Queue name where validated measurements are enqueued for blob batching
QUEUE_BLOB_BATCH="telemetry-to-blob"

# Queue name where validated measurements are enqueued for alert processing
QUEUE_ALERTS="telemetry-alerts"

# Queue name where validated measurements are enqueued for TimescaleDB writes
QUEUE_DB_WRITE="telemetry-db-write"

# ============================================================
# Function App
# ============================================================

# ============================================================
# HTTP API
# ============================================================

# API key required for all HTTP endpoints
HTTP_API_KEY="CHANGE_ME"



# ============================================================
# Static Web App (Web UI)
# Used by 60-staticwebapp.sh
# ============================================================

# Static Web App name (must be globally unique). Example: savoniaiot-ui-dev
STATICWEBAPP_NAME="savoniaiot-ui-dev"

# Static Web App SKU: Free | Standard
STATICWEBAPP_SKU="Free"

# Source directory for the UI (relative to the azure/ directory)
# Default: webui
STATICWEBAPP_SOURCE_DIR="webui"

# API base path used by the UI (usually /api)
API_BASE_PATH="/api"

# UI title (optional, cosmetic)
APP_TITLE="Savonia IoT"

# Function App name (must be globally unique). Example: savoniaiot-func-dev
FUNCTIONAPP_NAME="savoniaiot-func-dev"

# Azure Functions host version (v4 is recommended)
FUNCTIONAPP_FUNCTIONS_VERSION="4"

# Node.js runtime version for Azure Functions
FUNCTIONAPP_NODE_VERSION="22"

# Storage account used by the Function App (must be globally unique)
# NOTE: We will create this storage account in a later step.
FUNCTIONAPP_STORAGE_ACCOUNT="savoniaiotstdev"

# ============================================================
# Cold storage (Blob Storage – append blobs, hourly JSONL)
# ============================================================

# Blob container for cold telemetry storage
COLD_CONTAINER="telemetry-cold"

# Optional path prefix inside the container
COLD_PREFIX="telemetry"

# Gzip flag (currently ignored – append blobs are written as JSONL)
COLD_GZIP="false"

# ============================================================
# TimescaleDB / PostgreSQL
# ============================================================
# These are used by the Function App at runtime.
# The database itself will be provisioned later (Azure PostgreSQL Flexible Server).

# PostgreSQL deployment tier
# Allowed values:
#   dev  – minimal cost, non-HA (recommended for development)
#   prod – production defaults (HA-capable, higher cost)
POSTGRES_TIER="dev"

# PostgreSQL server location
# Can differ from AZURE_LOCATION if some regions restrict PostgreSQL Flexible Server
POSTGRES_LOCATION="francecentral"

# PostgreSQL major version
# Use a version supported by TimescaleDB on Azure (e.g. 14, 15, 16 depending on image)
POSTGRES_VERSION="16"

# PostgreSQL server hostname (without protocol)
# Example: savoniaiot-pg.postgres.database.azure.com
POSTGRES_HOST="savoniaiot-pg.postgres.database.azure.com"

# PostgreSQL port
POSTGRES_PORT="5432"

# Database name
POSTGRES_DATABASE="telemetry"

# Database user (typically <admin>@<server-name>)
POSTGRES_USER="telemetry_admin"

# Database password (SECRET – do not commit azure.env)
POSTGRES_PASSWORD="CHANGE_ME"

# SSL mode (Azure PostgreSQL requires SSL)
POSTGRES_SSLMODE="verify-full"

# How long measurments are kept in the database (in days)
TIMESCALE_RETENTION_DAYS="30"

# The timescale schema directory
TIMESCALE_SCHEMA_DIR="timescale"
